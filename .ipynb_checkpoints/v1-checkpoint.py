{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import scipy\n",
    "import pandas as pd\n",
    "import os\n",
    "from scipy.io import loadmat\n",
    "import numpy as np\n",
    "import math \n",
    "import collections\n",
    "import statistics\n",
    "from sklearn.datasets import make_classification\n",
    "from sklearn.model_selection import KFold\n",
    "from sklearn.svm import SVC\n",
    "from sklearn import metrics\n",
    "# import mrmr\n",
    "# from mrmr import mrmr_classif\n",
    "\n",
    "path = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/Files\"\n",
    "training_ids = loadmat(os.path.join(path,'trainingGroup.mat'))\n",
    "\n",
    "path2 = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/Files\"\n",
    "testing_ids = loadmat(os.path.join(path2,'testingGroup.mat'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "path = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/Files\"\n",
    "features = loadmat(os.path.join(path,'ROIstats_Tumor_5mm.mat'))\n",
    "roi_stats_tumor = pd.DataFrame(features['ROIstats_Tumor'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>186</th>\n",
       "      <th>187</th>\n",
       "      <th>188</th>\n",
       "      <th>189</th>\n",
       "      <th>190</th>\n",
       "      <th>191</th>\n",
       "      <th>192</th>\n",
       "      <th>193</th>\n",
       "      <th>194</th>\n",
       "      <th>195</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.410841</td>\n",
       "      <td>0.100405</td>\n",
       "      <td>-0.313258</td>\n",
       "      <td>-0.752497</td>\n",
       "      <td>0.407851</td>\n",
       "      <td>0.088581</td>\n",
       "      <td>-0.493569</td>\n",
       "      <td>-0.755417</td>\n",
       "      <td>0.408477</td>\n",
       "      <td>0.091009</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.378374</td>\n",
       "      <td>-0.789349</td>\n",
       "      <td>0.388178</td>\n",
       "      <td>0.098651</td>\n",
       "      <td>-0.378374</td>\n",
       "      <td>-0.789349</td>\n",
       "      <td>0.388178</td>\n",
       "      <td>0.098651</td>\n",
       "      <td>-0.378374</td>\n",
       "      <td>-0.789349</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.346387</td>\n",
       "      <td>0.05336</td>\n",
       "      <td>0.170914</td>\n",
       "      <td>0.973758</td>\n",
       "      <td>0.343953</td>\n",
       "      <td>0.045768</td>\n",
       "      <td>0.111171</td>\n",
       "      <td>0.600018</td>\n",
       "      <td>0.344606</td>\n",
       "      <td>0.045859</td>\n",
       "      <td>...</td>\n",
       "      <td>0.219822</td>\n",
       "      <td>0.757148</td>\n",
       "      <td>0.308604</td>\n",
       "      <td>0.052305</td>\n",
       "      <td>0.219822</td>\n",
       "      <td>0.757148</td>\n",
       "      <td>0.308604</td>\n",
       "      <td>0.052305</td>\n",
       "      <td>0.219822</td>\n",
       "      <td>0.757148</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.333582</td>\n",
       "      <td>0.052416</td>\n",
       "      <td>0.43467</td>\n",
       "      <td>1.984541</td>\n",
       "      <td>0.332697</td>\n",
       "      <td>0.049199</td>\n",
       "      <td>0.420148</td>\n",
       "      <td>1.437682</td>\n",
       "      <td>0.332892</td>\n",
       "      <td>0.049375</td>\n",
       "      <td>...</td>\n",
       "      <td>0.453566</td>\n",
       "      <td>1.906616</td>\n",
       "      <td>0.285421</td>\n",
       "      <td>0.052542</td>\n",
       "      <td>0.453566</td>\n",
       "      <td>1.906616</td>\n",
       "      <td>0.285421</td>\n",
       "      <td>0.052542</td>\n",
       "      <td>0.453566</td>\n",
       "      <td>1.906616</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.376179</td>\n",
       "      <td>0.066089</td>\n",
       "      <td>-0.077042</td>\n",
       "      <td>0.446638</td>\n",
       "      <td>0.373215</td>\n",
       "      <td>0.057342</td>\n",
       "      <td>-0.103612</td>\n",
       "      <td>0.283139</td>\n",
       "      <td>0.374155</td>\n",
       "      <td>0.058293</td>\n",
       "      <td>...</td>\n",
       "      <td>0.056391</td>\n",
       "      <td>0.26744</td>\n",
       "      <td>0.340293</td>\n",
       "      <td>0.064402</td>\n",
       "      <td>0.056391</td>\n",
       "      <td>0.26744</td>\n",
       "      <td>0.340293</td>\n",
       "      <td>0.064402</td>\n",
       "      <td>0.056391</td>\n",
       "      <td>0.26744</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.344729</td>\n",
       "      <td>0.051963</td>\n",
       "      <td>-0.877534</td>\n",
       "      <td>1.203404</td>\n",
       "      <td>0.34264</td>\n",
       "      <td>0.048641</td>\n",
       "      <td>-1.006341</td>\n",
       "      <td>1.136111</td>\n",
       "      <td>0.343222</td>\n",
       "      <td>0.048897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.598407</td>\n",
       "      <td>0.898564</td>\n",
       "      <td>0.327458</td>\n",
       "      <td>0.061096</td>\n",
       "      <td>-0.598407</td>\n",
       "      <td>0.898564</td>\n",
       "      <td>0.327458</td>\n",
       "      <td>0.061096</td>\n",
       "      <td>-0.598407</td>\n",
       "      <td>0.898564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>0.354117</td>\n",
       "      <td>0.050059</td>\n",
       "      <td>-0.510155</td>\n",
       "      <td>0.766049</td>\n",
       "      <td>0.352505</td>\n",
       "      <td>0.036562</td>\n",
       "      <td>-0.935184</td>\n",
       "      <td>1.31874</td>\n",
       "      <td>0.353009</td>\n",
       "      <td>0.037335</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.284181</td>\n",
       "      <td>0.711503</td>\n",
       "      <td>0.354506</td>\n",
       "      <td>0.052795</td>\n",
       "      <td>-0.284181</td>\n",
       "      <td>0.711503</td>\n",
       "      <td>0.354506</td>\n",
       "      <td>0.052795</td>\n",
       "      <td>-0.284181</td>\n",
       "      <td>0.711503</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>0.354063</td>\n",
       "      <td>0.030159</td>\n",
       "      <td>0.246317</td>\n",
       "      <td>-0.501566</td>\n",
       "      <td>0.354455</td>\n",
       "      <td>0.026401</td>\n",
       "      <td>0.316825</td>\n",
       "      <td>-0.533231</td>\n",
       "      <td>0.354334</td>\n",
       "      <td>0.027022</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.384496</td>\n",
       "      <td>-0.779786</td>\n",
       "      <td>0.32518</td>\n",
       "      <td>0.056249</td>\n",
       "      <td>-0.384496</td>\n",
       "      <td>-0.779786</td>\n",
       "      <td>0.32518</td>\n",
       "      <td>0.056249</td>\n",
       "      <td>-0.384496</td>\n",
       "      <td>-0.779786</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>0.353108</td>\n",
       "      <td>0.055919</td>\n",
       "      <td>-1.271877</td>\n",
       "      <td>1.110887</td>\n",
       "      <td>0.352655</td>\n",
       "      <td>0.052759</td>\n",
       "      <td>-1.299167</td>\n",
       "      <td>1.00762</td>\n",
       "      <td>0.352871</td>\n",
       "      <td>0.053363</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.297763</td>\n",
       "      <td>1.03593</td>\n",
       "      <td>0.352878</td>\n",
       "      <td>0.053832</td>\n",
       "      <td>-1.297763</td>\n",
       "      <td>1.03593</td>\n",
       "      <td>0.352878</td>\n",
       "      <td>0.053832</td>\n",
       "      <td>-1.297763</td>\n",
       "      <td>1.03593</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>0.37213</td>\n",
       "      <td>0.078054</td>\n",
       "      <td>0.516219</td>\n",
       "      <td>0.000629</td>\n",
       "      <td>0.370329</td>\n",
       "      <td>0.066301</td>\n",
       "      <td>0.465069</td>\n",
       "      <td>-0.337672</td>\n",
       "      <td>0.370441</td>\n",
       "      <td>0.067536</td>\n",
       "      <td>...</td>\n",
       "      <td>0.671959</td>\n",
       "      <td>0.619403</td>\n",
       "      <td>0.359911</td>\n",
       "      <td>0.081921</td>\n",
       "      <td>0.671959</td>\n",
       "      <td>0.619403</td>\n",
       "      <td>0.359911</td>\n",
       "      <td>0.081921</td>\n",
       "      <td>0.671959</td>\n",
       "      <td>0.619403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>0.318993</td>\n",
       "      <td>0.059092</td>\n",
       "      <td>0.704763</td>\n",
       "      <td>0.368692</td>\n",
       "      <td>0.31513</td>\n",
       "      <td>0.052616</td>\n",
       "      <td>0.676328</td>\n",
       "      <td>-0.032226</td>\n",
       "      <td>0.31593</td>\n",
       "      <td>0.052897</td>\n",
       "      <td>...</td>\n",
       "      <td>0.804224</td>\n",
       "      <td>0.21223</td>\n",
       "      <td>0.279042</td>\n",
       "      <td>0.061809</td>\n",
       "      <td>0.804224</td>\n",
       "      <td>0.21223</td>\n",
       "      <td>0.279042</td>\n",
       "      <td>0.061809</td>\n",
       "      <td>0.804224</td>\n",
       "      <td>0.21223</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>300 rows × 196 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          0         1         2         3         4         5         6     \n",
       "0    0.410841  0.100405 -0.313258 -0.752497  0.407851  0.088581 -0.493569  \\\n",
       "1    0.346387   0.05336  0.170914  0.973758  0.343953  0.045768  0.111171   \n",
       "2    0.333582  0.052416   0.43467  1.984541  0.332697  0.049199  0.420148   \n",
       "3    0.376179  0.066089 -0.077042  0.446638  0.373215  0.057342 -0.103612   \n",
       "4    0.344729  0.051963 -0.877534  1.203404   0.34264  0.048641 -1.006341   \n",
       "..        ...       ...       ...       ...       ...       ...       ...   \n",
       "295  0.354117  0.050059 -0.510155  0.766049  0.352505  0.036562 -0.935184   \n",
       "296  0.354063  0.030159  0.246317 -0.501566  0.354455  0.026401  0.316825   \n",
       "297  0.353108  0.055919 -1.271877  1.110887  0.352655  0.052759 -1.299167   \n",
       "298   0.37213  0.078054  0.516219  0.000629  0.370329  0.066301  0.465069   \n",
       "299  0.318993  0.059092  0.704763  0.368692   0.31513  0.052616  0.676328   \n",
       "\n",
       "          7         8         9    ...       186       187       188   \n",
       "0   -0.755417  0.408477  0.091009  ... -0.378374 -0.789349  0.388178  \\\n",
       "1    0.600018  0.344606  0.045859  ...  0.219822  0.757148  0.308604   \n",
       "2    1.437682  0.332892  0.049375  ...  0.453566  1.906616  0.285421   \n",
       "3    0.283139  0.374155  0.058293  ...  0.056391   0.26744  0.340293   \n",
       "4    1.136111  0.343222  0.048897  ... -0.598407  0.898564  0.327458   \n",
       "..        ...       ...       ...  ...       ...       ...       ...   \n",
       "295   1.31874  0.353009  0.037335  ... -0.284181  0.711503  0.354506   \n",
       "296 -0.533231  0.354334  0.027022  ... -0.384496 -0.779786   0.32518   \n",
       "297   1.00762  0.352871  0.053363  ... -1.297763   1.03593  0.352878   \n",
       "298 -0.337672  0.370441  0.067536  ...  0.671959  0.619403  0.359911   \n",
       "299 -0.032226   0.31593  0.052897  ...  0.804224   0.21223  0.279042   \n",
       "\n",
       "          189       190       191       192       193       194       195  \n",
       "0    0.098651 -0.378374 -0.789349  0.388178  0.098651 -0.378374 -0.789349  \n",
       "1    0.052305  0.219822  0.757148  0.308604  0.052305  0.219822  0.757148  \n",
       "2    0.052542  0.453566  1.906616  0.285421  0.052542  0.453566  1.906616  \n",
       "3    0.064402  0.056391   0.26744  0.340293  0.064402  0.056391   0.26744  \n",
       "4    0.061096 -0.598407  0.898564  0.327458  0.061096 -0.598407  0.898564  \n",
       "..        ...       ...       ...       ...       ...       ...       ...  \n",
       "295  0.052795 -0.284181  0.711503  0.354506  0.052795 -0.284181  0.711503  \n",
       "296  0.056249 -0.384496 -0.779786   0.32518  0.056249 -0.384496 -0.779786  \n",
       "297  0.053832 -1.297763   1.03593  0.352878  0.053832 -1.297763   1.03593  \n",
       "298  0.081921  0.671959  0.619403  0.359911  0.081921  0.671959  0.619403  \n",
       "299  0.061809  0.804224   0.21223  0.279042  0.061809  0.804224   0.21223  \n",
       "\n",
       "[300 rows x 196 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check whether data from email is the same as in dataframe\n",
    "# path = \"C:/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/TextureFeatures/Tumor\"\n",
    "path = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/TextureFeatures/Tumor\"\n",
    "# case = pd.DataFrame(loadmat(os.path.join(path, 'case_00000.mat'))['patientFeats'])\n",
    "# case.describe()\n",
    "ogStats = pd.DataFrame(index=range(300), columns=range(196)) \n",
    "for filename in os.listdir(path):\n",
    "#     print(int(filename[5:10]))\n",
    "    case = pd.DataFrame(loadmat(os.path.join(path, filename))['patientFeats'])\n",
    "    sList = []\n",
    "    for i in case.columns:\n",
    "        sList.append(case[i].mean())\n",
    "        sList.append(case[i].std())\n",
    "        sList.append(case[i].skew())\n",
    "        sList.append(case[i].kurtosis())\n",
    "    ogStats.loc[int(filename[5:10])] = sList\n",
    "ogStats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>382</th>\n",
       "      <th>383</th>\n",
       "      <th>384</th>\n",
       "      <th>385</th>\n",
       "      <th>386</th>\n",
       "      <th>387</th>\n",
       "      <th>388</th>\n",
       "      <th>389</th>\n",
       "      <th>390</th>\n",
       "      <th>391</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.410841</td>\n",
       "      <td>0.100405</td>\n",
       "      <td>-0.313258</td>\n",
       "      <td>-0.752497</td>\n",
       "      <td>0.407851</td>\n",
       "      <td>0.088581</td>\n",
       "      <td>-0.493569</td>\n",
       "      <td>-0.755417</td>\n",
       "      <td>0.408477</td>\n",
       "      <td>0.091009</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.65154</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.65154</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.65154</td>\n",
       "      <td>-0.548728</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.346387</td>\n",
       "      <td>0.05336</td>\n",
       "      <td>0.170914</td>\n",
       "      <td>0.973758</td>\n",
       "      <td>0.343953</td>\n",
       "      <td>0.045768</td>\n",
       "      <td>0.111171</td>\n",
       "      <td>0.600018</td>\n",
       "      <td>0.344606</td>\n",
       "      <td>0.045859</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.333582</td>\n",
       "      <td>0.052416</td>\n",
       "      <td>0.43467</td>\n",
       "      <td>1.984541</td>\n",
       "      <td>0.332697</td>\n",
       "      <td>0.049199</td>\n",
       "      <td>0.420148</td>\n",
       "      <td>1.437682</td>\n",
       "      <td>0.332892</td>\n",
       "      <td>0.049375</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "      <td>0.374188</td>\n",
       "      <td>0.10675</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "      <td>0.374188</td>\n",
       "      <td>0.10675</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.376179</td>\n",
       "      <td>0.066089</td>\n",
       "      <td>-0.077042</td>\n",
       "      <td>0.446638</td>\n",
       "      <td>0.373215</td>\n",
       "      <td>0.057342</td>\n",
       "      <td>-0.103612</td>\n",
       "      <td>0.283139</td>\n",
       "      <td>0.374155</td>\n",
       "      <td>0.058293</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "      <td>0.376041</td>\n",
       "      <td>0.082541</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "      <td>0.376041</td>\n",
       "      <td>0.082541</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.344729</td>\n",
       "      <td>0.051963</td>\n",
       "      <td>-0.877534</td>\n",
       "      <td>1.203404</td>\n",
       "      <td>0.34264</td>\n",
       "      <td>0.048641</td>\n",
       "      <td>-1.006341</td>\n",
       "      <td>1.136111</td>\n",
       "      <td>0.343222</td>\n",
       "      <td>0.048897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.06143</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.06143</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>0.354117</td>\n",
       "      <td>0.050059</td>\n",
       "      <td>-0.510155</td>\n",
       "      <td>0.766049</td>\n",
       "      <td>0.352505</td>\n",
       "      <td>0.036562</td>\n",
       "      <td>-0.935184</td>\n",
       "      <td>1.31874</td>\n",
       "      <td>0.353009</td>\n",
       "      <td>0.037335</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "      <td>0.340273</td>\n",
       "      <td>0.064371</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "      <td>0.340273</td>\n",
       "      <td>0.064371</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>0.354063</td>\n",
       "      <td>0.030159</td>\n",
       "      <td>0.246317</td>\n",
       "      <td>-0.501566</td>\n",
       "      <td>0.354455</td>\n",
       "      <td>0.026401</td>\n",
       "      <td>0.316825</td>\n",
       "      <td>-0.533231</td>\n",
       "      <td>0.354334</td>\n",
       "      <td>0.027022</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>0.353108</td>\n",
       "      <td>0.055919</td>\n",
       "      <td>-1.271877</td>\n",
       "      <td>1.110887</td>\n",
       "      <td>0.352655</td>\n",
       "      <td>0.052759</td>\n",
       "      <td>-1.299167</td>\n",
       "      <td>1.00762</td>\n",
       "      <td>0.352871</td>\n",
       "      <td>0.053363</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "      <td>0.332334</td>\n",
       "      <td>0.05819</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "      <td>0.332334</td>\n",
       "      <td>0.05819</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>0.37213</td>\n",
       "      <td>0.078054</td>\n",
       "      <td>0.516219</td>\n",
       "      <td>0.000629</td>\n",
       "      <td>0.370329</td>\n",
       "      <td>0.066301</td>\n",
       "      <td>0.465069</td>\n",
       "      <td>-0.337672</td>\n",
       "      <td>0.370441</td>\n",
       "      <td>0.067536</td>\n",
       "      <td>...</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "      <td>0.341282</td>\n",
       "      <td>0.103961</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "      <td>0.341282</td>\n",
       "      <td>0.103961</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>0.318993</td>\n",
       "      <td>0.059092</td>\n",
       "      <td>0.704763</td>\n",
       "      <td>0.368692</td>\n",
       "      <td>0.31513</td>\n",
       "      <td>0.052616</td>\n",
       "      <td>0.676328</td>\n",
       "      <td>-0.032226</td>\n",
       "      <td>0.31593</td>\n",
       "      <td>0.052897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "      <td>0.351893</td>\n",
       "      <td>0.081184</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "      <td>0.351893</td>\n",
       "      <td>0.081184</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>300 rows × 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          0         1         2         3         4         5         6     \n",
       "0    0.410841  0.100405 -0.313258 -0.752497  0.407851  0.088581 -0.493569  \\\n",
       "1    0.346387   0.05336  0.170914  0.973758  0.343953  0.045768  0.111171   \n",
       "2    0.333582  0.052416   0.43467  1.984541  0.332697  0.049199  0.420148   \n",
       "3    0.376179  0.066089 -0.077042  0.446638  0.373215  0.057342 -0.103612   \n",
       "4    0.344729  0.051963 -0.877534  1.203404   0.34264  0.048641 -1.006341   \n",
       "..        ...       ...       ...       ...       ...       ...       ...   \n",
       "295  0.354117  0.050059 -0.510155  0.766049  0.352505  0.036562 -0.935184   \n",
       "296  0.354063  0.030159  0.246317 -0.501566  0.354455  0.026401  0.316825   \n",
       "297  0.353108  0.055919 -1.271877  1.110887  0.352655  0.052759 -1.299167   \n",
       "298   0.37213  0.078054  0.516219  0.000629  0.370329  0.066301  0.465069   \n",
       "299  0.318993  0.059092  0.704763  0.368692   0.31513  0.052616  0.676328   \n",
       "\n",
       "          7         8         9    ...       382       383       384   \n",
       "0   -0.755417  0.408477  0.091009  ...  -0.65154 -0.548728  0.385283  \\\n",
       "1    0.600018  0.344606  0.045859  ... -0.408047 -1.137811  0.333622   \n",
       "2    1.437682  0.332892  0.049375  ... -0.601228 -1.021963  0.374188   \n",
       "3    0.283139  0.374155  0.058293  ... -0.483291 -0.553683  0.376041   \n",
       "4    1.136111  0.343222  0.048897  ... -0.301653  0.892964  0.311558   \n",
       "..        ...       ...       ...  ...       ...       ...       ...   \n",
       "295   1.31874  0.353009  0.037335  ... -0.383577 -0.353312  0.340273   \n",
       "296 -0.533231  0.354334  0.027022  ... -0.502118 -0.553132  0.361137   \n",
       "297   1.00762  0.352871  0.053363  ... -0.349421 -0.570594  0.332334   \n",
       "298 -0.337672  0.370441  0.067536  ...  0.998073  1.838918  0.341282   \n",
       "299 -0.032226   0.31593  0.052897  ... -0.520556 -0.802512  0.351893   \n",
       "\n",
       "          385       386       387       388       389       390       391  \n",
       "0    0.083743  -0.65154 -0.548728  0.385283  0.083743  -0.65154 -0.548728  \n",
       "1    0.092492 -0.408047 -1.137811  0.333622  0.092492 -0.408047 -1.137811  \n",
       "2     0.10675 -0.601228 -1.021963  0.374188   0.10675 -0.601228 -1.021963  \n",
       "3    0.082541 -0.483291 -0.553683  0.376041  0.082541 -0.483291 -0.553683  \n",
       "4     0.06143 -0.301653  0.892964  0.311558   0.06143 -0.301653  0.892964  \n",
       "..        ...       ...       ...       ...       ...       ...       ...  \n",
       "295  0.064371 -0.383577 -0.353312  0.340273  0.064371 -0.383577 -0.353312  \n",
       "296  0.048458 -0.502118 -0.553132  0.361137  0.048458 -0.502118 -0.553132  \n",
       "297   0.05819 -0.349421 -0.570594  0.332334   0.05819 -0.349421 -0.570594  \n",
       "298  0.103961  0.998073  1.838918  0.341282  0.103961  0.998073  1.838918  \n",
       "299  0.081184 -0.520556 -0.802512  0.351893  0.081184 -0.520556 -0.802512  \n",
       "\n",
       "[300 rows x 392 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Add peritumoural features\n",
    "path = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/TextureFeatures/InsideKidney/0-3mm\"\n",
    "newStats = pd.DataFrame(index=range(300), columns=range(196)) \n",
    "for filename in os.listdir(path):\n",
    "    case = pd.DataFrame(loadmat(os.path.join(path, filename))['patientFeats'])\n",
    "    sList = []\n",
    "    for i in case.columns:\n",
    "        sList.append(case[i].mean())\n",
    "        sList.append(case[i].std())\n",
    "        sList.append(case[i].skew())\n",
    "        sList.append(case[i].kurtosis())\n",
    "    newStats.loc[int(filename[5:10])] = sList\n",
    "allStats = pd.concat([ogStats, newStats], axis=1)\n",
    "allStats.columns = range(len(allStats.axes[1]))\n",
    "allStats.to_excel(r\"\\Users\\dhruv\\Desktop\\AI Research\\combinedDataframe.xlsx\", index=False)\n",
    "allStats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>382</th>\n",
       "      <th>383</th>\n",
       "      <th>384</th>\n",
       "      <th>385</th>\n",
       "      <th>386</th>\n",
       "      <th>387</th>\n",
       "      <th>388</th>\n",
       "      <th>389</th>\n",
       "      <th>390</th>\n",
       "      <th>391</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.410841</td>\n",
       "      <td>0.100405</td>\n",
       "      <td>-0.313258</td>\n",
       "      <td>-0.752497</td>\n",
       "      <td>0.407851</td>\n",
       "      <td>0.088581</td>\n",
       "      <td>-0.493569</td>\n",
       "      <td>-0.755417</td>\n",
       "      <td>0.408477</td>\n",
       "      <td>0.091009</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.346387</td>\n",
       "      <td>0.053360</td>\n",
       "      <td>0.170914</td>\n",
       "      <td>0.973758</td>\n",
       "      <td>0.343953</td>\n",
       "      <td>0.045768</td>\n",
       "      <td>0.111171</td>\n",
       "      <td>0.600018</td>\n",
       "      <td>0.344606</td>\n",
       "      <td>0.045859</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.333582</td>\n",
       "      <td>0.052416</td>\n",
       "      <td>0.434670</td>\n",
       "      <td>1.984541</td>\n",
       "      <td>0.332697</td>\n",
       "      <td>0.049199</td>\n",
       "      <td>0.420148</td>\n",
       "      <td>1.437682</td>\n",
       "      <td>0.332892</td>\n",
       "      <td>0.049375</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "      <td>0.374188</td>\n",
       "      <td>0.106750</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "      <td>0.374188</td>\n",
       "      <td>0.106750</td>\n",
       "      <td>-0.601228</td>\n",
       "      <td>-1.021963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.376179</td>\n",
       "      <td>0.066089</td>\n",
       "      <td>-0.077042</td>\n",
       "      <td>0.446638</td>\n",
       "      <td>0.373215</td>\n",
       "      <td>0.057342</td>\n",
       "      <td>-0.103612</td>\n",
       "      <td>0.283139</td>\n",
       "      <td>0.374155</td>\n",
       "      <td>0.058293</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "      <td>0.376041</td>\n",
       "      <td>0.082541</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "      <td>0.376041</td>\n",
       "      <td>0.082541</td>\n",
       "      <td>-0.483291</td>\n",
       "      <td>-0.553683</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.344729</td>\n",
       "      <td>0.051963</td>\n",
       "      <td>-0.877534</td>\n",
       "      <td>1.203404</td>\n",
       "      <td>0.342640</td>\n",
       "      <td>0.048641</td>\n",
       "      <td>-1.006341</td>\n",
       "      <td>1.136111</td>\n",
       "      <td>0.343222</td>\n",
       "      <td>0.048897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.061430</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.061430</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>0.354117</td>\n",
       "      <td>0.050059</td>\n",
       "      <td>-0.510155</td>\n",
       "      <td>0.766049</td>\n",
       "      <td>0.352505</td>\n",
       "      <td>0.036562</td>\n",
       "      <td>-0.935184</td>\n",
       "      <td>1.318740</td>\n",
       "      <td>0.353009</td>\n",
       "      <td>0.037335</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "      <td>0.340273</td>\n",
       "      <td>0.064371</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "      <td>0.340273</td>\n",
       "      <td>0.064371</td>\n",
       "      <td>-0.383577</td>\n",
       "      <td>-0.353312</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>0.354063</td>\n",
       "      <td>0.030159</td>\n",
       "      <td>0.246317</td>\n",
       "      <td>-0.501566</td>\n",
       "      <td>0.354455</td>\n",
       "      <td>0.026401</td>\n",
       "      <td>0.316825</td>\n",
       "      <td>-0.533231</td>\n",
       "      <td>0.354334</td>\n",
       "      <td>0.027022</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>0.353108</td>\n",
       "      <td>0.055919</td>\n",
       "      <td>-1.271877</td>\n",
       "      <td>1.110887</td>\n",
       "      <td>0.352655</td>\n",
       "      <td>0.052759</td>\n",
       "      <td>-1.299167</td>\n",
       "      <td>1.007620</td>\n",
       "      <td>0.352871</td>\n",
       "      <td>0.053363</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "      <td>0.332334</td>\n",
       "      <td>0.058190</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "      <td>0.332334</td>\n",
       "      <td>0.058190</td>\n",
       "      <td>-0.349421</td>\n",
       "      <td>-0.570594</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>0.372130</td>\n",
       "      <td>0.078054</td>\n",
       "      <td>0.516219</td>\n",
       "      <td>0.000629</td>\n",
       "      <td>0.370329</td>\n",
       "      <td>0.066301</td>\n",
       "      <td>0.465069</td>\n",
       "      <td>-0.337672</td>\n",
       "      <td>0.370441</td>\n",
       "      <td>0.067536</td>\n",
       "      <td>...</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "      <td>0.341282</td>\n",
       "      <td>0.103961</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "      <td>0.341282</td>\n",
       "      <td>0.103961</td>\n",
       "      <td>0.998073</td>\n",
       "      <td>1.838918</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>0.318993</td>\n",
       "      <td>0.059092</td>\n",
       "      <td>0.704763</td>\n",
       "      <td>0.368692</td>\n",
       "      <td>0.315130</td>\n",
       "      <td>0.052616</td>\n",
       "      <td>0.676328</td>\n",
       "      <td>-0.032226</td>\n",
       "      <td>0.315930</td>\n",
       "      <td>0.052897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "      <td>0.351893</td>\n",
       "      <td>0.081184</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "      <td>0.351893</td>\n",
       "      <td>0.081184</td>\n",
       "      <td>-0.520556</td>\n",
       "      <td>-0.802512</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>300 rows × 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          0         1         2         3         4         5         6     \n",
       "0    0.410841  0.100405 -0.313258 -0.752497  0.407851  0.088581 -0.493569  \\\n",
       "1    0.346387  0.053360  0.170914  0.973758  0.343953  0.045768  0.111171   \n",
       "2    0.333582  0.052416  0.434670  1.984541  0.332697  0.049199  0.420148   \n",
       "3    0.376179  0.066089 -0.077042  0.446638  0.373215  0.057342 -0.103612   \n",
       "4    0.344729  0.051963 -0.877534  1.203404  0.342640  0.048641 -1.006341   \n",
       "..        ...       ...       ...       ...       ...       ...       ...   \n",
       "295  0.354117  0.050059 -0.510155  0.766049  0.352505  0.036562 -0.935184   \n",
       "296  0.354063  0.030159  0.246317 -0.501566  0.354455  0.026401  0.316825   \n",
       "297  0.353108  0.055919 -1.271877  1.110887  0.352655  0.052759 -1.299167   \n",
       "298  0.372130  0.078054  0.516219  0.000629  0.370329  0.066301  0.465069   \n",
       "299  0.318993  0.059092  0.704763  0.368692  0.315130  0.052616  0.676328   \n",
       "\n",
       "          7         8         9    ...       382       383       384   \n",
       "0   -0.755417  0.408477  0.091009  ... -0.651540 -0.548728  0.385283  \\\n",
       "1    0.600018  0.344606  0.045859  ... -0.408047 -1.137811  0.333622   \n",
       "2    1.437682  0.332892  0.049375  ... -0.601228 -1.021963  0.374188   \n",
       "3    0.283139  0.374155  0.058293  ... -0.483291 -0.553683  0.376041   \n",
       "4    1.136111  0.343222  0.048897  ... -0.301653  0.892964  0.311558   \n",
       "..        ...       ...       ...  ...       ...       ...       ...   \n",
       "295  1.318740  0.353009  0.037335  ... -0.383577 -0.353312  0.340273   \n",
       "296 -0.533231  0.354334  0.027022  ... -0.502118 -0.553132  0.361137   \n",
       "297  1.007620  0.352871  0.053363  ... -0.349421 -0.570594  0.332334   \n",
       "298 -0.337672  0.370441  0.067536  ...  0.998073  1.838918  0.341282   \n",
       "299 -0.032226  0.315930  0.052897  ... -0.520556 -0.802512  0.351893   \n",
       "\n",
       "          385       386       387       388       389       390       391  \n",
       "0    0.083743 -0.651540 -0.548728  0.385283  0.083743 -0.651540 -0.548728  \n",
       "1    0.092492 -0.408047 -1.137811  0.333622  0.092492 -0.408047 -1.137811  \n",
       "2    0.106750 -0.601228 -1.021963  0.374188  0.106750 -0.601228 -1.021963  \n",
       "3    0.082541 -0.483291 -0.553683  0.376041  0.082541 -0.483291 -0.553683  \n",
       "4    0.061430 -0.301653  0.892964  0.311558  0.061430 -0.301653  0.892964  \n",
       "..        ...       ...       ...       ...       ...       ...       ...  \n",
       "295  0.064371 -0.383577 -0.353312  0.340273  0.064371 -0.383577 -0.353312  \n",
       "296  0.048458 -0.502118 -0.553132  0.361137  0.048458 -0.502118 -0.553132  \n",
       "297  0.058190 -0.349421 -0.570594  0.332334  0.058190 -0.349421 -0.570594  \n",
       "298  0.103961  0.998073  1.838918  0.341282  0.103961  0.998073  1.838918  \n",
       "299  0.081184 -0.520556 -0.802512  0.351893  0.081184 -0.520556 -0.802512  \n",
       "\n",
       "[300 rows x 392 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load the stored excel file\n",
    "allStats = pd.read_excel(r'\\Users\\dhruv\\Desktop\\AI Research\\combinedDataframe.xlsx')\n",
    "allStats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>382</th>\n",
       "      <th>383</th>\n",
       "      <th>384</th>\n",
       "      <th>385</th>\n",
       "      <th>386</th>\n",
       "      <th>387</th>\n",
       "      <th>388</th>\n",
       "      <th>389</th>\n",
       "      <th>390</th>\n",
       "      <th>391</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.429725</td>\n",
       "      <td>0.085325</td>\n",
       "      <td>-1.253611</td>\n",
       "      <td>0.934438</td>\n",
       "      <td>0.428434</td>\n",
       "      <td>0.083179</td>\n",
       "      <td>-1.330143</td>\n",
       "      <td>1.002477</td>\n",
       "      <td>0.428884</td>\n",
       "      <td>0.083625</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.205138</td>\n",
       "      <td>-0.269862</td>\n",
       "      <td>0.384609</td>\n",
       "      <td>0.116490</td>\n",
       "      <td>-0.205138</td>\n",
       "      <td>-0.269862</td>\n",
       "      <td>0.384609</td>\n",
       "      <td>0.116490</td>\n",
       "      <td>-0.205138</td>\n",
       "      <td>-0.269862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.331688</td>\n",
       "      <td>0.040704</td>\n",
       "      <td>-0.301121</td>\n",
       "      <td>1.680213</td>\n",
       "      <td>0.329803</td>\n",
       "      <td>0.035127</td>\n",
       "      <td>-0.532560</td>\n",
       "      <td>1.523264</td>\n",
       "      <td>0.330410</td>\n",
       "      <td>0.034916</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.666184</td>\n",
       "      <td>-0.288588</td>\n",
       "      <td>0.376538</td>\n",
       "      <td>0.071770</td>\n",
       "      <td>-0.666184</td>\n",
       "      <td>-0.288588</td>\n",
       "      <td>0.376538</td>\n",
       "      <td>0.071770</td>\n",
       "      <td>-0.666184</td>\n",
       "      <td>-0.288588</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.455426</td>\n",
       "      <td>0.117479</td>\n",
       "      <td>-0.285385</td>\n",
       "      <td>-0.611685</td>\n",
       "      <td>0.450953</td>\n",
       "      <td>0.097248</td>\n",
       "      <td>-0.167481</td>\n",
       "      <td>-0.649576</td>\n",
       "      <td>0.452191</td>\n",
       "      <td>0.101632</td>\n",
       "      <td>...</td>\n",
       "      <td>0.069517</td>\n",
       "      <td>-1.273329</td>\n",
       "      <td>0.373030</td>\n",
       "      <td>0.136027</td>\n",
       "      <td>0.069517</td>\n",
       "      <td>-1.273329</td>\n",
       "      <td>0.373030</td>\n",
       "      <td>0.136027</td>\n",
       "      <td>0.069517</td>\n",
       "      <td>-1.273329</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.407505</td>\n",
       "      <td>0.080076</td>\n",
       "      <td>-0.435072</td>\n",
       "      <td>-0.157929</td>\n",
       "      <td>0.405853</td>\n",
       "      <td>0.070332</td>\n",
       "      <td>-0.527916</td>\n",
       "      <td>-0.079006</td>\n",
       "      <td>0.406258</td>\n",
       "      <td>0.071947</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.405388</td>\n",
       "      <td>-0.517457</td>\n",
       "      <td>0.357707</td>\n",
       "      <td>0.082841</td>\n",
       "      <td>-0.405388</td>\n",
       "      <td>-0.517457</td>\n",
       "      <td>0.357707</td>\n",
       "      <td>0.082841</td>\n",
       "      <td>-0.405388</td>\n",
       "      <td>-0.517457</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.404259</td>\n",
       "      <td>0.044361</td>\n",
       "      <td>-1.448175</td>\n",
       "      <td>3.067505</td>\n",
       "      <td>0.403723</td>\n",
       "      <td>0.038110</td>\n",
       "      <td>-1.595820</td>\n",
       "      <td>3.545971</td>\n",
       "      <td>0.404102</td>\n",
       "      <td>0.039176</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.145694</td>\n",
       "      <td>0.410215</td>\n",
       "      <td>0.353733</td>\n",
       "      <td>0.076325</td>\n",
       "      <td>-0.145694</td>\n",
       "      <td>0.410215</td>\n",
       "      <td>0.353733</td>\n",
       "      <td>0.076325</td>\n",
       "      <td>-0.145694</td>\n",
       "      <td>0.410215</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>0.343921</td>\n",
       "      <td>0.043464</td>\n",
       "      <td>-0.290737</td>\n",
       "      <td>3.749277</td>\n",
       "      <td>0.343722</td>\n",
       "      <td>0.040714</td>\n",
       "      <td>-0.395807</td>\n",
       "      <td>2.311454</td>\n",
       "      <td>0.343798</td>\n",
       "      <td>0.041187</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.155488</td>\n",
       "      <td>-0.357661</td>\n",
       "      <td>0.326966</td>\n",
       "      <td>0.069204</td>\n",
       "      <td>-0.155488</td>\n",
       "      <td>-0.357661</td>\n",
       "      <td>0.326966</td>\n",
       "      <td>0.069204</td>\n",
       "      <td>-0.155488</td>\n",
       "      <td>-0.357661</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>0.371298</td>\n",
       "      <td>0.058435</td>\n",
       "      <td>-0.634080</td>\n",
       "      <td>0.755627</td>\n",
       "      <td>0.368600</td>\n",
       "      <td>0.050424</td>\n",
       "      <td>-0.864413</td>\n",
       "      <td>0.719898</td>\n",
       "      <td>0.369364</td>\n",
       "      <td>0.051040</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.667796</td>\n",
       "      <td>-0.069800</td>\n",
       "      <td>0.319582</td>\n",
       "      <td>0.058693</td>\n",
       "      <td>-0.667796</td>\n",
       "      <td>-0.069800</td>\n",
       "      <td>0.319582</td>\n",
       "      <td>0.058693</td>\n",
       "      <td>-0.667796</td>\n",
       "      <td>-0.069800</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>0.346442</td>\n",
       "      <td>0.050859</td>\n",
       "      <td>0.294748</td>\n",
       "      <td>-0.872808</td>\n",
       "      <td>0.345726</td>\n",
       "      <td>0.047084</td>\n",
       "      <td>0.264355</td>\n",
       "      <td>-1.018365</td>\n",
       "      <td>0.345919</td>\n",
       "      <td>0.047916</td>\n",
       "      <td>...</td>\n",
       "      <td>0.002388</td>\n",
       "      <td>-0.603891</td>\n",
       "      <td>0.339980</td>\n",
       "      <td>0.087680</td>\n",
       "      <td>0.002388</td>\n",
       "      <td>-0.603891</td>\n",
       "      <td>0.339980</td>\n",
       "      <td>0.087680</td>\n",
       "      <td>0.002388</td>\n",
       "      <td>-0.603891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>0.389627</td>\n",
       "      <td>0.043350</td>\n",
       "      <td>-1.221438</td>\n",
       "      <td>3.502341</td>\n",
       "      <td>0.389464</td>\n",
       "      <td>0.034193</td>\n",
       "      <td>-1.806318</td>\n",
       "      <td>5.099455</td>\n",
       "      <td>0.389564</td>\n",
       "      <td>0.034682</td>\n",
       "      <td>...</td>\n",
       "      <td>-1.128538</td>\n",
       "      <td>1.523388</td>\n",
       "      <td>0.353703</td>\n",
       "      <td>0.050501</td>\n",
       "      <td>-1.128538</td>\n",
       "      <td>1.523388</td>\n",
       "      <td>0.353703</td>\n",
       "      <td>0.050501</td>\n",
       "      <td>-1.128538</td>\n",
       "      <td>1.523388</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>0.369276</td>\n",
       "      <td>0.049513</td>\n",
       "      <td>-1.140264</td>\n",
       "      <td>1.292906</td>\n",
       "      <td>0.368692</td>\n",
       "      <td>0.045431</td>\n",
       "      <td>-1.138256</td>\n",
       "      <td>1.116097</td>\n",
       "      <td>0.368989</td>\n",
       "      <td>0.046079</td>\n",
       "      <td>...</td>\n",
       "      <td>0.221956</td>\n",
       "      <td>-0.438145</td>\n",
       "      <td>0.340014</td>\n",
       "      <td>0.086651</td>\n",
       "      <td>0.221956</td>\n",
       "      <td>-0.438145</td>\n",
       "      <td>0.340014</td>\n",
       "      <td>0.086651</td>\n",
       "      <td>0.221956</td>\n",
       "      <td>-0.438145</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>200 rows × 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          0         1         2         3         4         5         6     \n",
       "0    0.429725  0.085325 -1.253611  0.934438  0.428434  0.083179 -1.330143  \\\n",
       "1    0.331688  0.040704 -0.301121  1.680213  0.329803  0.035127 -0.532560   \n",
       "2    0.455426  0.117479 -0.285385 -0.611685  0.450953  0.097248 -0.167481   \n",
       "3    0.407505  0.080076 -0.435072 -0.157929  0.405853  0.070332 -0.527916   \n",
       "4    0.404259  0.044361 -1.448175  3.067505  0.403723  0.038110 -1.595820   \n",
       "..        ...       ...       ...       ...       ...       ...       ...   \n",
       "195  0.343921  0.043464 -0.290737  3.749277  0.343722  0.040714 -0.395807   \n",
       "196  0.371298  0.058435 -0.634080  0.755627  0.368600  0.050424 -0.864413   \n",
       "197  0.346442  0.050859  0.294748 -0.872808  0.345726  0.047084  0.264355   \n",
       "198  0.389627  0.043350 -1.221438  3.502341  0.389464  0.034193 -1.806318   \n",
       "199  0.369276  0.049513 -1.140264  1.292906  0.368692  0.045431 -1.138256   \n",
       "\n",
       "          7         8         9    ...       382       383       384   \n",
       "0    1.002477  0.428884  0.083625  ... -0.205138 -0.269862  0.384609  \\\n",
       "1    1.523264  0.330410  0.034916  ... -0.666184 -0.288588  0.376538   \n",
       "2   -0.649576  0.452191  0.101632  ...  0.069517 -1.273329  0.373030   \n",
       "3   -0.079006  0.406258  0.071947  ... -0.405388 -0.517457  0.357707   \n",
       "4    3.545971  0.404102  0.039176  ... -0.145694  0.410215  0.353733   \n",
       "..        ...       ...       ...  ...       ...       ...       ...   \n",
       "195  2.311454  0.343798  0.041187  ... -0.155488 -0.357661  0.326966   \n",
       "196  0.719898  0.369364  0.051040  ... -0.667796 -0.069800  0.319582   \n",
       "197 -1.018365  0.345919  0.047916  ...  0.002388 -0.603891  0.339980   \n",
       "198  5.099455  0.389564  0.034682  ... -1.128538  1.523388  0.353703   \n",
       "199  1.116097  0.368989  0.046079  ...  0.221956 -0.438145  0.340014   \n",
       "\n",
       "          385       386       387       388       389       390       391  \n",
       "0    0.116490 -0.205138 -0.269862  0.384609  0.116490 -0.205138 -0.269862  \n",
       "1    0.071770 -0.666184 -0.288588  0.376538  0.071770 -0.666184 -0.288588  \n",
       "2    0.136027  0.069517 -1.273329  0.373030  0.136027  0.069517 -1.273329  \n",
       "3    0.082841 -0.405388 -0.517457  0.357707  0.082841 -0.405388 -0.517457  \n",
       "4    0.076325 -0.145694  0.410215  0.353733  0.076325 -0.145694  0.410215  \n",
       "..        ...       ...       ...       ...       ...       ...       ...  \n",
       "195  0.069204 -0.155488 -0.357661  0.326966  0.069204 -0.155488 -0.357661  \n",
       "196  0.058693 -0.667796 -0.069800  0.319582  0.058693 -0.667796 -0.069800  \n",
       "197  0.087680  0.002388 -0.603891  0.339980  0.087680  0.002388 -0.603891  \n",
       "198  0.050501 -1.128538  1.523388  0.353703  0.050501 -1.128538  1.523388  \n",
       "199  0.086651  0.221956 -0.438145  0.340014  0.086651  0.221956 -0.438145  \n",
       "\n",
       "[200 rows x 392 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create training matrix\n",
    "training_matrix = pd.DataFrame(columns=allStats.columns)\n",
    "train_ids = (training_ids[\"trainingGroup\"]).flatten()\n",
    "\n",
    "for train_id in train_ids:\n",
    "    training_matrix.loc[len(training_matrix.index)] = allStats.loc[train_id-1]\n",
    "\n",
    "training_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>...</th>\n",
       "      <th>382</th>\n",
       "      <th>383</th>\n",
       "      <th>384</th>\n",
       "      <th>385</th>\n",
       "      <th>386</th>\n",
       "      <th>387</th>\n",
       "      <th>388</th>\n",
       "      <th>389</th>\n",
       "      <th>390</th>\n",
       "      <th>391</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.410841</td>\n",
       "      <td>0.100405</td>\n",
       "      <td>-0.313258</td>\n",
       "      <td>-0.752497</td>\n",
       "      <td>0.407851</td>\n",
       "      <td>0.088581</td>\n",
       "      <td>-0.493569</td>\n",
       "      <td>-0.755417</td>\n",
       "      <td>0.408477</td>\n",
       "      <td>0.091009</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "      <td>0.385283</td>\n",
       "      <td>0.083743</td>\n",
       "      <td>-0.651540</td>\n",
       "      <td>-0.548728</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.346387</td>\n",
       "      <td>0.053360</td>\n",
       "      <td>0.170914</td>\n",
       "      <td>0.973758</td>\n",
       "      <td>0.343953</td>\n",
       "      <td>0.045768</td>\n",
       "      <td>0.111171</td>\n",
       "      <td>0.600018</td>\n",
       "      <td>0.344606</td>\n",
       "      <td>0.045859</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "      <td>0.333622</td>\n",
       "      <td>0.092492</td>\n",
       "      <td>-0.408047</td>\n",
       "      <td>-1.137811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.344729</td>\n",
       "      <td>0.051963</td>\n",
       "      <td>-0.877534</td>\n",
       "      <td>1.203404</td>\n",
       "      <td>0.342640</td>\n",
       "      <td>0.048641</td>\n",
       "      <td>-1.006341</td>\n",
       "      <td>1.136111</td>\n",
       "      <td>0.343222</td>\n",
       "      <td>0.048897</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.061430</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "      <td>0.311558</td>\n",
       "      <td>0.061430</td>\n",
       "      <td>-0.301653</td>\n",
       "      <td>0.892964</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.353593</td>\n",
       "      <td>0.065665</td>\n",
       "      <td>-0.852719</td>\n",
       "      <td>-0.047498</td>\n",
       "      <td>0.352138</td>\n",
       "      <td>0.062585</td>\n",
       "      <td>-0.866827</td>\n",
       "      <td>-0.167973</td>\n",
       "      <td>0.352608</td>\n",
       "      <td>0.063154</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.363594</td>\n",
       "      <td>-1.383228</td>\n",
       "      <td>0.288868</td>\n",
       "      <td>0.101806</td>\n",
       "      <td>-0.363594</td>\n",
       "      <td>-1.383228</td>\n",
       "      <td>0.288868</td>\n",
       "      <td>0.101806</td>\n",
       "      <td>-0.363594</td>\n",
       "      <td>-1.383228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.370433</td>\n",
       "      <td>0.044183</td>\n",
       "      <td>-1.007604</td>\n",
       "      <td>1.742997</td>\n",
       "      <td>0.369965</td>\n",
       "      <td>0.039911</td>\n",
       "      <td>-1.087470</td>\n",
       "      <td>1.823192</td>\n",
       "      <td>0.370219</td>\n",
       "      <td>0.040586</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.892033</td>\n",
       "      <td>0.677909</td>\n",
       "      <td>0.348827</td>\n",
       "      <td>0.056110</td>\n",
       "      <td>-0.892033</td>\n",
       "      <td>0.677909</td>\n",
       "      <td>0.348827</td>\n",
       "      <td>0.056110</td>\n",
       "      <td>-0.892033</td>\n",
       "      <td>0.677909</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>0.390084</td>\n",
       "      <td>0.054458</td>\n",
       "      <td>-1.326432</td>\n",
       "      <td>2.114190</td>\n",
       "      <td>0.389333</td>\n",
       "      <td>0.049726</td>\n",
       "      <td>-1.416686</td>\n",
       "      <td>2.250316</td>\n",
       "      <td>0.389753</td>\n",
       "      <td>0.050603</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.914567</td>\n",
       "      <td>0.046531</td>\n",
       "      <td>0.377126</td>\n",
       "      <td>0.077510</td>\n",
       "      <td>-0.914567</td>\n",
       "      <td>0.046531</td>\n",
       "      <td>0.377126</td>\n",
       "      <td>0.077510</td>\n",
       "      <td>-0.914567</td>\n",
       "      <td>0.046531</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>0.307966</td>\n",
       "      <td>0.050457</td>\n",
       "      <td>0.221142</td>\n",
       "      <td>1.744889</td>\n",
       "      <td>0.306211</td>\n",
       "      <td>0.047551</td>\n",
       "      <td>0.140879</td>\n",
       "      <td>1.365098</td>\n",
       "      <td>0.306670</td>\n",
       "      <td>0.047616</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.030609</td>\n",
       "      <td>-0.710116</td>\n",
       "      <td>0.417111</td>\n",
       "      <td>0.144275</td>\n",
       "      <td>-0.030609</td>\n",
       "      <td>-0.710116</td>\n",
       "      <td>0.417111</td>\n",
       "      <td>0.144275</td>\n",
       "      <td>-0.030609</td>\n",
       "      <td>-0.710116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>0.315991</td>\n",
       "      <td>0.056214</td>\n",
       "      <td>-0.192709</td>\n",
       "      <td>0.475891</td>\n",
       "      <td>0.315276</td>\n",
       "      <td>0.054041</td>\n",
       "      <td>-0.193059</td>\n",
       "      <td>0.423628</td>\n",
       "      <td>0.315473</td>\n",
       "      <td>0.054327</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.465069</td>\n",
       "      <td>-1.257241</td>\n",
       "      <td>0.315816</td>\n",
       "      <td>0.099042</td>\n",
       "      <td>-0.465069</td>\n",
       "      <td>-1.257241</td>\n",
       "      <td>0.315816</td>\n",
       "      <td>0.099042</td>\n",
       "      <td>-0.465069</td>\n",
       "      <td>-1.257241</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>0.317711</td>\n",
       "      <td>0.030634</td>\n",
       "      <td>-1.774320</td>\n",
       "      <td>4.230097</td>\n",
       "      <td>0.317378</td>\n",
       "      <td>0.027659</td>\n",
       "      <td>-2.038979</td>\n",
       "      <td>4.831865</td>\n",
       "      <td>0.317525</td>\n",
       "      <td>0.027903</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.570857</td>\n",
       "      <td>-0.588073</td>\n",
       "      <td>0.290678</td>\n",
       "      <td>0.045411</td>\n",
       "      <td>-0.570857</td>\n",
       "      <td>-0.588073</td>\n",
       "      <td>0.290678</td>\n",
       "      <td>0.045411</td>\n",
       "      <td>-0.570857</td>\n",
       "      <td>-0.588073</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>0.354063</td>\n",
       "      <td>0.030159</td>\n",
       "      <td>0.246317</td>\n",
       "      <td>-0.501566</td>\n",
       "      <td>0.354455</td>\n",
       "      <td>0.026401</td>\n",
       "      <td>0.316825</td>\n",
       "      <td>-0.533231</td>\n",
       "      <td>0.354334</td>\n",
       "      <td>0.027022</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "      <td>0.361137</td>\n",
       "      <td>0.048458</td>\n",
       "      <td>-0.502118</td>\n",
       "      <td>-0.553132</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         0         1         2         3         4         5         6     \n",
       "0   0.410841  0.100405 -0.313258 -0.752497  0.407851  0.088581 -0.493569  \\\n",
       "1   0.346387  0.053360  0.170914  0.973758  0.343953  0.045768  0.111171   \n",
       "2   0.344729  0.051963 -0.877534  1.203404  0.342640  0.048641 -1.006341   \n",
       "3   0.353593  0.065665 -0.852719 -0.047498  0.352138  0.062585 -0.866827   \n",
       "4   0.370433  0.044183 -1.007604  1.742997  0.369965  0.039911 -1.087470   \n",
       "..       ...       ...       ...       ...       ...       ...       ...   \n",
       "95  0.390084  0.054458 -1.326432  2.114190  0.389333  0.049726 -1.416686   \n",
       "96  0.307966  0.050457  0.221142  1.744889  0.306211  0.047551  0.140879   \n",
       "97  0.315991  0.056214 -0.192709  0.475891  0.315276  0.054041 -0.193059   \n",
       "98  0.317711  0.030634 -1.774320  4.230097  0.317378  0.027659 -2.038979   \n",
       "99  0.354063  0.030159  0.246317 -0.501566  0.354455  0.026401  0.316825   \n",
       "\n",
       "         7         8         9    ...       382       383       384       385   \n",
       "0  -0.755417  0.408477  0.091009  ... -0.651540 -0.548728  0.385283  0.083743  \\\n",
       "1   0.600018  0.344606  0.045859  ... -0.408047 -1.137811  0.333622  0.092492   \n",
       "2   1.136111  0.343222  0.048897  ... -0.301653  0.892964  0.311558  0.061430   \n",
       "3  -0.167973  0.352608  0.063154  ... -0.363594 -1.383228  0.288868  0.101806   \n",
       "4   1.823192  0.370219  0.040586  ... -0.892033  0.677909  0.348827  0.056110   \n",
       "..       ...       ...       ...  ...       ...       ...       ...       ...   \n",
       "95  2.250316  0.389753  0.050603  ... -0.914567  0.046531  0.377126  0.077510   \n",
       "96  1.365098  0.306670  0.047616  ... -0.030609 -0.710116  0.417111  0.144275   \n",
       "97  0.423628  0.315473  0.054327  ... -0.465069 -1.257241  0.315816  0.099042   \n",
       "98  4.831865  0.317525  0.027903  ... -0.570857 -0.588073  0.290678  0.045411   \n",
       "99 -0.533231  0.354334  0.027022  ... -0.502118 -0.553132  0.361137  0.048458   \n",
       "\n",
       "         386       387       388       389       390       391  \n",
       "0  -0.651540 -0.548728  0.385283  0.083743 -0.651540 -0.548728  \n",
       "1  -0.408047 -1.137811  0.333622  0.092492 -0.408047 -1.137811  \n",
       "2  -0.301653  0.892964  0.311558  0.061430 -0.301653  0.892964  \n",
       "3  -0.363594 -1.383228  0.288868  0.101806 -0.363594 -1.383228  \n",
       "4  -0.892033  0.677909  0.348827  0.056110 -0.892033  0.677909  \n",
       "..       ...       ...       ...       ...       ...       ...  \n",
       "95 -0.914567  0.046531  0.377126  0.077510 -0.914567  0.046531  \n",
       "96 -0.030609 -0.710116  0.417111  0.144275 -0.030609 -0.710116  \n",
       "97 -0.465069 -1.257241  0.315816  0.099042 -0.465069 -1.257241  \n",
       "98 -0.570857 -0.588073  0.290678  0.045411 -0.570857 -0.588073  \n",
       "99 -0.502118 -0.553132  0.361137  0.048458 -0.502118 -0.553132  \n",
       "\n",
       "[100 rows x 392 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create testing matrix\n",
    "testing_matrix = pd.DataFrame(columns=allStats.columns)\n",
    "test_ids = (testing_ids[\"testingGroup\"]).flatten()\n",
    "\n",
    "for test_id in test_ids:\n",
    "    testing_matrix.loc[len(testing_matrix.index)] = allStats.loc[test_id-1]\n",
    "\n",
    "testing_matrix"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Excel file format cannot be determined, you must specify an engine manually.",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[24], line 1\u001b[0m\n\u001b[0;32m----> 1\u001b[0m datas \u001b[38;5;241m=\u001b[39m \u001b[43mpd\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mread_excel\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m/Users/dhruv/Desktop/AI Research/KiTS21_ClinicalData.csv\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[1;32m      3\u001b[0m datas[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mISUP\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m datas[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mISUP\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mreplace([\u001b[38;5;241m1.0\u001b[39m, \u001b[38;5;241m2.0\u001b[39m], \u001b[38;5;241m0\u001b[39m)\n\u001b[1;32m      4\u001b[0m datas[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mISUP\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m datas[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mISUP\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mreplace([\u001b[38;5;241m3.0\u001b[39m, \u001b[38;5;241m4.0\u001b[39m], \u001b[38;5;241m1\u001b[39m)\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/io/excel/_base.py:478\u001b[0m, in \u001b[0;36mread_excel\u001b[0;34m(io, sheet_name, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, storage_options, dtype_backend)\u001b[0m\n\u001b[1;32m    476\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(io, ExcelFile):\n\u001b[1;32m    477\u001b[0m     should_close \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[0;32m--> 478\u001b[0m     io \u001b[38;5;241m=\u001b[39m \u001b[43mExcelFile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mio\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mstorage_options\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mengine\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mengine\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    479\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m engine \u001b[38;5;129;01mand\u001b[39;00m engine \u001b[38;5;241m!=\u001b[39m io\u001b[38;5;241m.\u001b[39mengine:\n\u001b[1;32m    480\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[1;32m    481\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mEngine should not be specified when passing \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    482\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124man ExcelFile - ExcelFile already has the engine set\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    483\u001b[0m     )\n",
      "File \u001b[0;32m/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pandas/io/excel/_base.py:1500\u001b[0m, in \u001b[0;36mExcelFile.__init__\u001b[0;34m(self, path_or_buffer, engine, storage_options)\u001b[0m\n\u001b[1;32m   1496\u001b[0m     ext \u001b[38;5;241m=\u001b[39m inspect_excel_format(\n\u001b[1;32m   1497\u001b[0m         content_or_path\u001b[38;5;241m=\u001b[39mpath_or_buffer, storage_options\u001b[38;5;241m=\u001b[39mstorage_options\n\u001b[1;32m   1498\u001b[0m     )\n\u001b[1;32m   1499\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m ext \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m-> 1500\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[1;32m   1501\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mExcel file format cannot be determined, you must specify \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   1502\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124man engine manually.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   1503\u001b[0m         )\n\u001b[1;32m   1505\u001b[0m engine \u001b[38;5;241m=\u001b[39m config\u001b[38;5;241m.\u001b[39mget_option(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mio.excel.\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mext\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m.reader\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[1;32m   1506\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m engine \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mauto\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "\u001b[0;31mValueError\u001b[0m: Excel file format cannot be determined, you must specify an engine manually."
     ]
    }
   ],
   "source": [
    "datas = pd.read_excel(\"/Users/dhruv/Desktop/AI Research/KiTS21_ClinicalData.csv\")\n",
    "\n",
    "datas['ISUP'] = datas['ISUP'].replace([1.0, 2.0], 0)\n",
    "datas['ISUP'] = datas['ISUP'].replace([3.0, 4.0], 1)\n",
    "datas = datas.fillna(0)\n",
    "\n",
    "datas['T-grade'] = datas['T-grade'].replace(['1a', '1b', '2a', '2b'], 0)\n",
    "datas['T-grade'] = datas['T-grade'].replace([3, 4], 1)\n",
    "datas = datas.fillna(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# print((datas['T-grade'] == 1).sum())\n",
    "datas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_inds = [num - 1 for num in (training_ids[\"trainingGroup\"]).flatten()]\n",
    "test_inds = [num - 1 for num in (testing_ids[\"testingGroup\"]).flatten()]\n",
    "\n",
    "trainISUP = datas['ISUP'].iloc[train_inds].squeeze()\n",
    "testISUP = datas['ISUP'].iloc[test_inds].squeeze()\n",
    "\n",
    "trainTgrade = datas['T-grade'].iloc[train_inds].squeeze()\n",
    "testTgrade = datas['T-grade'].iloc[test_inds].squeeze()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# def cvClassify(feats,label):\n",
    "#     n_runs = 20\n",
    "#     k = 3\n",
    "\n",
    "#     auc_cv = []\n",
    "#     feats_cv = []\n",
    "\n",
    "#     for r in range(n_runs):\n",
    "\n",
    "#         kf = KFold(n_splits=k, shuffle=True)\n",
    "\n",
    "#         for train, test in kf.split(feats):\n",
    "#             feats_train = feats.loc[train, :]\n",
    "#             label_train = label.loc[train]\n",
    "\n",
    "#             feats_test = feats.loc[test, :]\n",
    "#             label_test = label.loc[test]\n",
    "\n",
    "#             # K = 10% of # rows of feats\n",
    "#             select_feats = mrmr.mrmr_classif(X=feats_train, y=label_train, K=int(round(len(feats_train.index) / 10)))\n",
    "            \n",
    "#             feats_cv.extend(select_feats)\n",
    "\n",
    "#             feats_train = feats_train.loc[:,select_feats]\n",
    "#             feats_test = feats_test.loc[:,select_feats]\n",
    "\n",
    "#             feats_train_ = feats_train.to_numpy()\n",
    "#             label_train_ = label_train.to_numpy()\n",
    "\n",
    "#             feats_test_ = feats_test.to_numpy()\n",
    "#             label_test_ = label_test.to_numpy()\n",
    "\n",
    "#             model = SVC(gamma='auto', probability=True)\n",
    "#             model.fit(feats_train,label_train)\n",
    "\n",
    "#             probs_test = model.predict_proba(feats_test_)\n",
    "#             fpr, tpr, thresholds = metrics.roc_curve(label_test_, probs_test[:,1], pos_label=1)\n",
    "#             auc_cv.append(metrics.auc(fpr,tpr))\n",
    "\n",
    "\n",
    "#     counter = collections.Counter(feats_cv)\n",
    "\n",
    "#     top_feats_sorted = np.array(counter.most_common(5))\n",
    "#     top_feats = top_feats_sorted[:,0]\n",
    "\n",
    "#     final_feats = feats.loc[:, top_feats]\n",
    "#     final_feats = final_feats.to_numpy()\n",
    "#     label = label.to_numpy()\n",
    "\n",
    "#     final_model = SVC(gamma='auto', probability=True)\n",
    "#     final_model.fit(final_feats,label)\n",
    "\n",
    "#     return statistics.mean(auc_cv), final_model, top_feats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from boruta import BorutaPy\n",
    "\n",
    "def cvClassify(feats,label):\n",
    "    n_runs = 3\n",
    "    k = 10\n",
    "\n",
    "    auc_cv = []\n",
    "    feats_cv = []\n",
    "\n",
    "    for r in range(n_runs):\n",
    "        \n",
    "        kf = KFold(n_splits=k, shuffle=True)\n",
    "        \n",
    "        for train, test in kf.split(feats):\n",
    "            feats_train = feats.iloc[train, :]\n",
    "            label_train = label.iloc[train]\n",
    "\n",
    "            feats_test = feats.iloc[test, :]\n",
    "            label_test = label.iloc[test]\n",
    "            \n",
    "            rf = RandomForestClassifier(n_jobs=-1, class_weight='balanced', max_depth=5)\n",
    "            feat_selector = BorutaPy(rf, n_estimators='auto', verbose=2, random_state=1)\n",
    "\n",
    "            # changed some values to numpy arrays by adding .values\n",
    "            feat_selector.fit(feats_train.values, label_train.values)\n",
    "\n",
    "            feats_train_ = feat_selector.transform(feats_train.values)\n",
    "            select_feats = feat_selector.support_   # creates a boolean mask of used values in the training feats\n",
    "            select_feats = np.argwhere(select_feats == True)\n",
    "            feats_cv.extend(select_feats)\n",
    "            \n",
    "#             feats_train = feats_train.iloc[:,select_feats]\n",
    "#             feats_test = feats_test.iloc[:,select_feats]\n",
    "            feats_train = feats_train.values[:,select_feats]\n",
    "            feats_test = feats_test.values[:,select_feats]\n",
    "            \n",
    "            feats_train = feats_train.reshape(feats_train.shape[0], feats_train.shape[1]) #reshape to 2D array\n",
    "            feats_test = feats_test.reshape(feats_test.shape[0], feats_test.shape[1]) #reshape to 2D array\n",
    "\n",
    "            feats_train_ = feats_train\n",
    "            label_train_ = label_train\n",
    "\n",
    "            feats_test_ = feats_test\n",
    "            label_test_ = label_test\n",
    "            \n",
    "            print(feats_train.shape)\n",
    "            model = rf.fit(feats_train,label_train)\n",
    "\n",
    "            probs_test = model.predict_proba(feats_test_)\n",
    "            fpr, tpr, thresholds = metrics.roc_curve(label_test_, probs_test[:,1], pos_label=1)\n",
    "            auc_cv.append(metrics.auc(fpr,tpr))\n",
    "    \n",
    "    feats_cv = [x[0] for x in feats_cv] # Convert each NumPy array to a tuple\n",
    "    counter = collections.Counter(feats_cv)\n",
    "    top_feats_sorted = np.array(counter.most_common(5))\n",
    "    top_feats = top_feats_sorted[:,0]\n",
    "\n",
    "    final_feats = feats.iloc[:, top_feats]\n",
    "    final_feats = final_feats#.to_numpy()\n",
    "    label = label.to_numpy()\n",
    "\n",
    "#     final_model = RandomForestClassifier(gamma='auto', probability=True)\n",
    "    final_model = RandomForestClassifier()\n",
    "    final_model.fit(final_feats,label)\n",
    "\n",
    "    return statistics.mean(auc_cv), final_model, top_feats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "if __name__ == \"__main__\":\n",
    "    \n",
    "    # feats1 and label1 are for train, feats2 and label2 are for test\n",
    "        \n",
    "    feats1 = training_matrix\n",
    "    feats2 = testing_matrix\n",
    "    \n",
    "    load_labels = loadmat(os.path.join(\"G:/.shortcut-targets-by-id/1YKJmC9bzTUqncCWUJdAy3ZSVLcEt10UD/KiTS Project/Files\",'trainLabel.mat'))\n",
    "    label1 = pd.Series((load_labels['trainLabel']).flatten())\n",
    "#     label1 = trainISUP.reset_index(drop=True)\n",
    "    \n",
    "    load_labels = loadmat(os.path.join(\"G:/.shortcut-targets-by-id/1YKJmC9bzTUqncCWUJdAy3ZSVLcEt10UD/KiTS Project/Files\",'testLabel.mat'))\n",
    "    label2 = pd.Series((load_labels['testLabel']).flatten())\n",
    "#     label2 = testISUP.reset_index(drop=True)\n",
    "    \n",
    "    cvAUC, cvModel, topFeats = cvClassify(feats1,label1)\n",
    "    print(\"cross validation AUC is \"+ str(cvAUC))\n",
    "    print(\"Columns with the most commonly used features:\" + str(topFeats))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "    # ValueError: X.shape[1] = 192 should be equal to 5, the number of features at training time\n",
    "    # Am I supposed to set feats2 as only the most used columns?\n",
    "#     feats2 = feats2.to_numpy()\n",
    "#     label2 = label2.to_numpy()\n",
    "    topFeatsMatrix = feats2.iloc[:, topFeats]\n",
    "    probs_ = cvModel.predict_proba(topFeatsMatrix)\n",
    "\n",
    "    fpr, tpr, thresholds = metrics.roc_curve(label2, probs_[:,1], pos_label=1)\n",
    "    testAUC = metrics.auc(fpr,tpr)\n",
    "    print(\"test AUC is \"+ str(testAUC))\n",
    "    pred0 = 0\n",
    "    pred1 = 1\n",
    "    for i in range(len(probs_)):\n",
    "        print(probs_[i], \", label: \", label2[i])\n",
    "        if label2[i] == 0:\n",
    "            pred0+=1\n",
    "        else:\n",
    "            pred1+=1\n",
    "    print(pred0)\n",
    "    print(pred1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "import json\n",
    "\n",
    "path = \"/Users/dhruv/OneDrive - Georgia Institute of Technology/KiTS Project/RawData/case_00000/raw/meta.json\"\n",
    "meta = json.load(open(path))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'x_spacing': 0.919921875,\n",
       " 'y_spacing': 0.919921875,\n",
       " 'z_spacing': 0.5,\n",
       " 'num_images': 611}"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "meta"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'__header__': b'MATLAB 5.0 MAT-file, Platform: PCWIN64, Created on: Thu May 12 16:15:18 2022',\n",
       " '__version__': '1.0',\n",
       " '__globals__': [],\n",
       " 'trainingGroup': array([[183],\n",
       "        [147],\n",
       "        [274],\n",
       "        [ 42],\n",
       "        [ 52],\n",
       "        [ 28],\n",
       "        [276],\n",
       "        [ 44],\n",
       "        [229],\n",
       "        [138],\n",
       "        [267],\n",
       "        [137],\n",
       "        [219],\n",
       "        [174],\n",
       "        [164],\n",
       "        [188],\n",
       "        [257],\n",
       "        [ 46],\n",
       "        [  8],\n",
       "        [176],\n",
       "        [244],\n",
       "        [ 77],\n",
       "        [221],\n",
       "        [  4],\n",
       "        [144],\n",
       "        [258],\n",
       "        [204],\n",
       "        [101],\n",
       "        [ 21],\n",
       "        [209],\n",
       "        [203],\n",
       "        [102],\n",
       "        [167],\n",
       "        [ 15],\n",
       "        [149],\n",
       "        [ 76],\n",
       "        [154],\n",
       "        [280],\n",
       "        [ 40],\n",
       "        [201],\n",
       "        [226],\n",
       "        [ 61],\n",
       "        [300],\n",
       "        [119],\n",
       "        [ 88],\n",
       "        [165],\n",
       "        [268],\n",
       "        [220],\n",
       "        [227],\n",
       "        [255],\n",
       "        [116],\n",
       "        [120],\n",
       "        [107],\n",
       "        [ 90],\n",
       "        [104],\n",
       "        [192],\n",
       "        [156],\n",
       "        [202],\n",
       "        [ 70],\n",
       "        [ 43],\n",
       "        [ 10],\n",
       "        [131],\n",
       "        [296],\n",
       "        [151],\n",
       "        [ 50],\n",
       "        [148],\n",
       "        [239],\n",
       "        [ 86],\n",
       "        [118],\n",
       "        [213],\n",
       "        [125],\n",
       "        [269],\n",
       "        [243],\n",
       "        [135],\n",
       "        [ 55],\n",
       "        [254],\n",
       "        [ 38],\n",
       "        [189],\n",
       "        [217],\n",
       "        [256],\n",
       "        [228],\n",
       "        [ 22],\n",
       "        [196],\n",
       "        [ 53],\n",
       "        [175],\n",
       "        [ 63],\n",
       "        [162],\n",
       "        [291],\n",
       "        [146],\n",
       "        [124],\n",
       "        [ 19],\n",
       "        [236],\n",
       "        [ 62],\n",
       "        [235],\n",
       "        [ 78],\n",
       "        [ 92],\n",
       "        [214],\n",
       "        [153],\n",
       "        [139],\n",
       "        [169],\n",
       "        [ 11],\n",
       "        [294],\n",
       "        [100],\n",
       "        [129],\n",
       "        [207],\n",
       "        [136],\n",
       "        [145],\n",
       "        [266],\n",
       "        [206],\n",
       "        [128],\n",
       "        [ 87],\n",
       "        [155],\n",
       "        [121],\n",
       "        [212],\n",
       "        [  7],\n",
       "        [ 65],\n",
       "        [290],\n",
       "        [283],\n",
       "        [157],\n",
       "        [ 73],\n",
       "        [ 39],\n",
       "        [ 26],\n",
       "        [286],\n",
       "        [181],\n",
       "        [264],\n",
       "        [224],\n",
       "        [299],\n",
       "        [ 17],\n",
       "        [178],\n",
       "        [234],\n",
       "        [247],\n",
       "        [122],\n",
       "        [161],\n",
       "        [242],\n",
       "        [289],\n",
       "        [ 99],\n",
       "        [282],\n",
       "        [  3],\n",
       "        [111],\n",
       "        [ 95],\n",
       "        [263],\n",
       "        [ 82],\n",
       "        [158],\n",
       "        [ 97],\n",
       "        [103],\n",
       "        [ 91],\n",
       "        [208],\n",
       "        [193],\n",
       "        [284],\n",
       "        [123],\n",
       "        [237],\n",
       "        [140],\n",
       "        [179],\n",
       "        [163],\n",
       "        [ 84],\n",
       "        [ 45],\n",
       "        [108],\n",
       "        [171],\n",
       "        [261],\n",
       "        [238],\n",
       "        [ 71],\n",
       "        [222],\n",
       "        [  6],\n",
       "        [ 64],\n",
       "        [218],\n",
       "        [127],\n",
       "        [172],\n",
       "        [110],\n",
       "        [106],\n",
       "        [ 36],\n",
       "        [115],\n",
       "        [ 37],\n",
       "        [195],\n",
       "        [ 85],\n",
       "        [298],\n",
       "        [271],\n",
       "        [ 31],\n",
       "        [190],\n",
       "        [211],\n",
       "        [287],\n",
       "        [249],\n",
       "        [270],\n",
       "        [295],\n",
       "        [173],\n",
       "        [ 48],\n",
       "        [ 54],\n",
       "        [200],\n",
       "        [ 68],\n",
       "        [199],\n",
       "        [ 79],\n",
       "        [281],\n",
       "        [191],\n",
       "        [ 81],\n",
       "        [132],\n",
       "        [141],\n",
       "        [275],\n",
       "        [277],\n",
       "        [ 80],\n",
       "        [215],\n",
       "        [  9]], dtype=uint16)}"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "training_ids"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "index=range(300)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
